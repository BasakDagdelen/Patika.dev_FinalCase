2025-05-07 00:08:07.907 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:08:08.752 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:08:08.754 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:08:08.757 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:08:08.758 +03:00 [INF] Hosting environment: Development
2025-05-07 00:08:08.758 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:08:14.561 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:08:15.090 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 541.1746ms
2025-05-07 00:08:15.133 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:08:15.133 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:08:15.143 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 9.5859ms
2025-05-07 00:08:15.220 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 87.2469ms
2025-05-07 00:08:17.697 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:08:17.937 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 240.8993ms
2025-05-07 00:08:42.208 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 70
2025-05-07 00:08:43.841 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:08:43.881 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 00:08:45.465 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:08:47.348 +03:00 [INF] Executed DbCommand (316ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 00:08:47.546 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2076.3901ms.
2025-05-07 00:08:47.555 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 00:08:47.573 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 3687.5982ms
2025-05-07 00:08:47.574 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:08:47.578 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 5341.4828 ms
2025-05-07 00:08:47.590 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 5381.3638ms
2025-05-07 00:09:24.543 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/ExpenseCategory - null null
2025-05-07 00:09:24.665 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:09:24.675 +03:00 [INF] Route matched with {action = "GetAll", controller = "ExpenseCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.ExpenseCategoryResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.ExpenseCategoryController (Expense_Management_System.WebApi).
2025-05-07 00:09:24.795 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:09:24.843 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[Description], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[Name], [e].[UpdatedDate], [e].[UpdatedUser]
FROM [ExpenseCategories] AS [e]
2025-05-07 00:09:24.917 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetAll (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 122.6212ms.
2025-05-07 00:09:24.920 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseCategoryResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 00:09:24.942 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetAll (Expense_Management_System.WebApi) in 266.3959ms
2025-05-07 00:09:24.942 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:09:24.942 +03:00 [INF] HTTP GET /api/ExpenseCategory responded 200 in 395.4526 ms
2025-05-07 00:09:24.970 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/ExpenseCategory - 200 null application/json; charset=utf-8 426.6918ms
2025-05-07 00:09:43.238 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/ExpenseCategory - application/json 49
2025-05-07 00:09:43.278 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:09:43.283 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 00:09:43.283 +03:00 [INF] HTTP POST /api/ExpenseCategory responded 403 in 24.8629 ms
2025-05-07 00:09:43.283 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/ExpenseCategory - 403 0 null 45.5637ms
2025-05-07 00:10:17.597 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - null null
2025-05-07 00:10:17.606 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:10:17.615 +03:00 [INF] Route matched with {action = "GetById", controller = "ExpenseCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseCategoryResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseCategoryController (Expense_Management_System.WebApi).
2025-05-07 00:10:17.667 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:10:17.752 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Description], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[Name], [e].[UpdatedDate], [e].[UpdatedUser]
FROM [ExpenseCategories] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:10:17.756 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 88.1505ms.
2025-05-07 00:10:17.756 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseCategoryResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 00:10:17.758 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetById (Expense_Management_System.WebApi) in 142.7595ms
2025-05-07 00:10:17.758 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseCategoryController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:10:17.758 +03:00 [INF] HTTP GET /api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 responded 200 in 154.2820 ms
2025-05-07 00:10:17.759 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - 200 null application/json; charset=utf-8 161.8798ms
2025-05-07 00:10:24.481 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - application/json 49
2025-05-07 00:10:24.482 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:10:24.482 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 00:10:24.482 +03:00 [INF] HTTP PUT /api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 responded 403 in 0.5925 ms
2025-05-07 00:10:24.482 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - 403 0 null 0.9892ms
2025-05-07 00:10:30.494 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - null null
2025-05-07 00:10:30.495 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:10:30.495 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 00:10:30.495 +03:00 [INF] HTTP DELETE /api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 responded 403 in 0.7405 ms
2025-05-07 00:10:30.495 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/ExpenseCategory/fd6143cd-b454-4b21-9524-d7d128f8ad05 - 403 0 null 1.6391ms
2025-05-07 00:12:02.624 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense - multipart/form-data; boundary=----WebKitFormBoundaryHBCgaJiuyl1PRlMC 728
2025-05-07 00:12:02.627 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi)'
2025-05-07 00:12:02.649 +03:00 [INF] Route matched with {action = "Create", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Create(Expense_Management_System.Application.DTOs.Requests.ExpenseRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:12:51.204 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:12:51.870 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:12:51.871 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:12:51.876 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:12:51.877 +03:00 [INF] Hosting environment: Development
2025-05-07 00:12:51.877 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:12:55.978 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:12:56.628 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 663.5254ms
2025-05-07 00:12:56.722 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:12:56.722 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:12:56.731 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 9.6221ms
2025-05-07 00:12:56.840 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.4623ms
2025-05-07 00:12:58.294 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:12:58.674 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 380.3529ms
2025-05-07 00:13:42.185 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense - multipart/form-data; boundary=----WebKitFormBoundaryRo98zDsyEF6Kf17S 183285
2025-05-07 00:13:42.488 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi)'
2025-05-07 00:13:42.526 +03:00 [INF] Route matched with {action = "Create", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Create(Expense_Management_System.Application.DTOs.Requests.ExpenseRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:13:43.923 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:13:44.812 +03:00 [INF] Executed DbCommand (154ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (Size = 250), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (Size = 300), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 250), @p14='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Expenses] ([Id], [Amount], [ApprovedAt], [ApprovedByUserId], [Description], [ExpenseCategoryId], [InsertedDate], [InsertedUser], [PaymentLocation], [PaymentMethod], [RejectionReason], [Status], [UpdatedDate], [UpdatedUser], [UserId])
OUTPUT INSERTED.[IsActive]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-05-07 00:13:44.947 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 250), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 250), @p6='?' (DbType = DateTime2), @p7='?' (Size = 250), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ExpenseDocuments] ([Id], [ExpenseId], [FileName], [FilePath], [InsertedDate], [InsertedUser], [UpdatedDate], [UpdatedUser], [UploadDate])
OUTPUT INSERTED.[IsActive]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-05-07 00:13:44.961 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1033.3603ms.
2025-05-07 00:13:44.971 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 00:13:45.028 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi) in 2498.5607ms
2025-05-07 00:13:45.029 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Create (Expense_Management_System.WebApi)'
2025-05-07 00:13:45.033 +03:00 [INF] HTTP POST /api/Expense responded 200 in 2831.4511 ms
2025-05-07 00:13:45.049 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense - 200 null application/json; charset=utf-8 2863.2945ms
2025-05-07 00:15:44.234 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - multipart/form-data; boundary=----WebKitFormBoundaryh3fbkaW6Uk9Zsshp 391814
2025-05-07 00:15:44.270 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:15:44.275 +03:00 [INF] Route matched with {action = "Update", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.ExpenseRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:15:44.399 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:15:44.813 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:15:44.855 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 500), @p2='?' (Size = 100), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Size = 250)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [Amount] = @p0, [Description] = @p1, [PaymentLocation] = @p2, [PaymentMethod] = @p3, [UpdatedDate] = @p4, [UpdatedUser] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2025-05-07 00:15:45.149 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.Update (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 750.116ms.
2025-05-07 00:15:45.150 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 00:15:45.150 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Update (Expense_Management_System.WebApi) in 875.0912ms
2025-05-07 00:15:45.150 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:15:45.150 +03:00 [INF] HTTP PUT /api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 889.6512 ms
2025-05-07 00:15:45.152 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 918.7108ms
2025-05-07 00:17:26.909 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 00:17:26.935 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:17:26.941 +03:00 [INF] Route matched with {action = "Delete", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.String]] Delete(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:17:27.058 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Delete (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:17:27.078 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:17:27.099 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-07 00:17:27.113 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p15='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (Size = 250), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (Size = 300), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 250), @p14='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [Amount] = @p0, [ApprovedAt] = @p1, [ApprovedByUserId] = @p2, [Description] = @p3, [ExpenseCategoryId] = @p4, [InsertedDate] = @p5, [InsertedUser] = @p6, [IsActive] = @p7, [PaymentLocation] = @p8, [PaymentMethod] = @p9, [RejectionReason] = @p10, [Status] = @p11, [UpdatedDate] = @p12, [UpdatedUser] = @p13, [UserId] = @p14
OUTPUT 1
WHERE [Id] = @p15;
2025-05-07 00:17:27.115 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.Delete (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 56.045ms.
2025-05-07 00:17:27.115 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 00:17:27.116 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Delete (Expense_Management_System.WebApi) in 175.4782ms
2025-05-07 00:17:27.117 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:17:27.117 +03:00 [INF] HTTP DELETE /api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 192.4224 ms
2025-05-07 00:17:27.117 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 208.6575ms
2025-05-07 00:18:11.864 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 00:18:11.876 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:18:11.883 +03:00 [INF] Route matched with {action = "GetById", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:18:11.916 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:18:11.922 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:18:11.924 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 7.9846ms.
2025-05-07 00:18:11.924 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 00:18:11.925 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.GetById (Expense_Management_System.WebApi) in 42.1234ms
2025-05-07 00:18:11.925 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:18:11.925 +03:00 [INF] HTTP GET /api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 58.8894 ms
2025-05-07 00:18:11.925 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 62.6226ms
2025-05-07 00:21:02.788 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - null 0
2025-05-07 00:21:02.813 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:02'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 00:21:02.827 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:02'.
2025-05-07 00:21:02.829 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:21:02.841 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 00:21:02.841 +03:00 [INF] HTTP POST /api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad responded 401 in 51.8158 ms
2025-05-07 00:21:02.841 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - 401 0 null 58.6816ms
2025-05-07 00:21:23.523 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 00:21:23.524 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:23'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 00:21:23.525 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:23'.
2025-05-07 00:21:23.525 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:21:23.531 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 00:21:23.630 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:21:23.653 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 00:21:23.690 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 60.1323ms.
2025-05-07 00:21:23.691 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 00:21:23.693 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 161.3346ms
2025-05-07 00:21:23.693 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:21:23.693 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 170.1316 ms
2025-05-07 00:21:23.697 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 175.1671ms
2025-05-07 00:21:53.716 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - null 0
2025-05-07 00:21:53.720 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:53'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 00:21:53.721 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:07:14', Current time (UTC): '6.05.2025 21:21:53'.
2025-05-07 00:21:53.721 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:21:53.722 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 00:21:53.722 +03:00 [INF] HTTP POST /api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad responded 401 in 4.7576 ms
2025-05-07 00:21:53.722 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - 401 0 null 6.164ms
2025-05-07 00:22:29.065 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - null 0
2025-05-07 00:22:29.069 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi)'
2025-05-07 00:22:29.089 +03:00 [INF] Route matched with {action = "Approve", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Approve(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 00:22:29.118 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:22:29.135 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:22:29.153 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [ApprovedAt] = @p0, [ApprovedByUserId] = @p1, [Status] = @p2, [UpdatedDate] = @p3
OUTPUT 1
WHERE [Id] = @p4;
2025-05-07 00:23:10.465 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:23:11.108 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:23:11.108 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:23:11.110 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:23:11.111 +03:00 [INF] Hosting environment: Development
2025-05-07 00:23:11.111 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:23:15.319 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:23:15.998 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 696.683ms
2025-05-07 00:23:16.024 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:23:16.024 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:23:16.035 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 11.2154ms
2025-05-07 00:23:16.130 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 106.5235ms
2025-05-07 00:23:17.862 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:23:18.249 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 388.1538ms
2025-05-07 00:25:21.116 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/User - null null
2025-05-07 00:25:21.419 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:25:21.458 +03:00 [INF] Route matched with {action = "GetAll", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:25:22.862 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:25:23.699 +03:00 [INF] Executed DbCommand (142ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
2025-05-07 00:25:23.831 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 963.9882ms.
2025-05-07 00:25:23.840 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 00:25:23.872 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi) in 2407.1909ms
2025-05-07 00:25:23.872 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:25:23.876 +03:00 [INF] HTTP GET /api/User responded 200 in 2732.1747 ms
2025-05-07 00:25:23.882 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/User - 200 null application/json; charset=utf-8 2767.0225ms
2025-05-07 00:26:04.656 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - application/json 273
2025-05-07 00:26:04.681 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:26:04.693 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:26:04.920 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:26:05.418 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:26:05.473 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 00:26:06.113 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 00:26:06.137 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 00:26:06.469 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 1776.1488ms
2025-05-07 00:26:06.470 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:26:06.471 +03:00 [ERR] HTTP PUT /api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 responded 500 in 1795.1852 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:d40e69c6-86a9-4281-b56e-d1e019b54895
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method150(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:26:06.542 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:d40e69c6-86a9-4281-b56e-d1e019b54895
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method150(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:26:06.554 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - 500 null text/plain; charset=utf-8 1897.4893ms
2025-05-07 00:29:03.492 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:29:04.218 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:29:04.220 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:29:04.224 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:29:04.224 +03:00 [INF] Hosting environment: Development
2025-05-07 00:29:04.224 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:29:08.449 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:29:09.109 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:29:09.111 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:29:09.119 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 677.1633ms
2025-05-07 00:29:09.119 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 10.0298ms
2025-05-07 00:29:09.231 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.7714ms
2025-05-07 00:29:11.132 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:29:11.516 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 383.7206ms
2025-05-07 00:29:52.457 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - application/json 274
2025-05-07 00:29:52.639 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:29:52.643 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 00:29:52.645 +03:00 [INF] HTTP PUT /api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 responded 401 in 172.8677 ms
2025-05-07 00:29:52.646 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - 401 0 null 189.7419ms
2025-05-07 00:30:29.630 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - application/json 274
2025-05-07 00:30:29.772 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:30:29.834 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:30:31.499 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:30:32.657 +03:00 [INF] Executed DbCommand (188ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:30:32.809 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 00:30:33.310 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 00:30:33.328 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 00:30:33.696 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 3858.6848ms
2025-05-07 00:30:33.698 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:30:33.700 +03:00 [ERR] HTTP PUT /api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 responded 500 in 4056.0618 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:aedf7fd8-71df-42bf-9703-d06669db881f
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:30:33.762 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:aedf7fd8-71df-42bf-9703-d06669db881f
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:30:33.796 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/d290f1ee-6c54-4b01-90e6-d701748f0851 - 500 null text/plain; charset=utf-8 4166.5992ms
2025-05-07 00:31:46.070 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/User/36ca1936-767b-492f-9d71-d19475eab931 - null null
2025-05-07 00:31:46.114 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:31:46.126 +03:00 [INF] Route matched with {action = "Delete", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse] Delete(System.Guid) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:31:46.401 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:31:46.418 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:31:46.450 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-07 00:31:46.467 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p13='?' (DbType = Guid), @p0='?' (Size = 200), @p1='?' (Size = 100), @p2='?' (Size = 50), @p3='?' (DbType = DateTime2), @p4='?' (Size = 250), @p5='?' (DbType = Boolean), @p6='?' (Size = 50), @p7='?' (Size = 255), @p8='?' (Size = 15), @p9='?' (Size = 4000), @p10='?' (DbType = DateTime2), @p11='?' (Size = 250), @p12='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Address] = @p0, [Email] = @p1, [FirstName] = @p2, [InsertedDate] = @p3, [InsertedUser] = @p4, [IsActive] = @p5, [LastName] = @p6, [PasswordHash] = @p7, [PhoneNumber] = @p8, [Role] = @p9, [UpdatedDate] = @p10, [UpdatedUser] = @p11, [WorkPhoneNumber] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2025-05-07 00:31:46.490 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 81.9324ms.
2025-05-07 00:31:46.501 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse'.
2025-05-07 00:31:46.517 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi) in 390.2484ms
2025-05-07 00:31:46.517 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:31:46.517 +03:00 [INF] HTTP DELETE /api/User/36ca1936-767b-492f-9d71-d19475eab931 responded 200 in 410.5462 ms
2025-05-07 00:31:46.518 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/User/36ca1936-767b-492f-9d71-d19475eab931 - 200 null application/json; charset=utf-8 447.8455ms
2025-05-07 00:32:02.776 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/User/36ca1936-767b-492f-9d71-d19475eab931 - null null
2025-05-07 00:32:02.777 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:32:02.778 +03:00 [INF] Route matched with {action = "Delete", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse] Delete(System.Guid) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:32:02.849 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:32:02.855 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:32:02.855 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 6.4749ms.
2025-05-07 00:32:02.856 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse'.
2025-05-07 00:32:02.856 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi) in 78.4421ms
2025-05-07 00:32:02.856 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:32:02.856 +03:00 [INF] HTTP DELETE /api/User/36ca1936-767b-492f-9d71-d19475eab931 responded 200 in 79.2598 ms
2025-05-07 00:32:02.856 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/User/36ca1936-767b-492f-9d71-d19475eab931 - 200 null application/json; charset=utf-8 81.0456ms
2025-05-07 00:37:03.387 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:37:04.123 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:37:04.124 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:37:04.129 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:37:04.130 +03:00 [INF] Hosting environment: Development
2025-05-07 00:37:04.130 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:37:10.515 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:37:11.126 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 626.9296ms
2025-05-07 00:37:11.176 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:37:11.177 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:37:11.202 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 26.449ms
2025-05-07 00:37:11.267 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 90.2259ms
2025-05-07 00:37:15.071 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:37:15.439 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 367.9078ms
2025-05-07 00:37:36.005 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/ExpenseDocument - null null
2025-05-07 00:37:36.267 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:37:36.302 +03:00 [INF] Route matched with {action = "GetAll", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:37:36.431 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:39:41.780 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:39:42.395 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:39:42.395 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:39:42.398 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:39:42.399 +03:00 [INF] Hosting environment: Development
2025-05-07 00:39:42.399 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:39:44.954 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:39:47.307 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 2368.6182ms
2025-05-07 00:39:47.370 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:39:47.371 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:39:47.390 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 18.4012ms
2025-05-07 00:39:47.486 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 116.5496ms
2025-05-07 00:39:49.759 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:39:50.153 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 395.2289ms
2025-05-07 00:39:57.955 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/ExpenseDocument - null null
2025-05-07 00:39:58.200 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:39:58.234 +03:00 [INF] Route matched with {action = "GetAll", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:39:59.678 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:40:00.946 +03:00 [INF] Executed DbCommand (225ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[ExpenseId], [e].[FileName], [e].[FilePath], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UploadDate], [e0].[Id], [e0].[Amount], [e0].[ApprovedAt], [e0].[ApprovedByUserId], [e0].[Description], [e0].[ExpenseCategoryId], [e0].[InsertedDate], [e0].[InsertedUser], [e0].[IsActive], [e0].[PaymentLocation], [e0].[PaymentMethod], [e0].[RejectionReason], [e0].[Status], [e0].[UpdatedDate], [e0].[UpdatedUser], [e0].[UserId]
FROM [ExpenseDocuments] AS [e]
INNER JOIN [Expenses] AS [e0] ON [e].[ExpenseId] = [e0].[Id]
WHERE [e0].[UserId] = @__userId_0
2025-05-07 00:40:01.188 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1503.8433ms.
2025-05-07 00:40:01.198 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 00:40:01.233 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi) in 2994.1458ms
2025-05-07 00:40:01.234 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 00:40:01.237 +03:00 [INF] HTTP GET /api/ExpenseDocument responded 200 in 3273.0397 ms
2025-05-07 00:40:01.247 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/ExpenseDocument - 200 null application/json; charset=utf-8 3292.7459ms
2025-05-07 00:40:28.231 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/ExpenseDocument/95822304-e9b2-4dab-b0eb-e9ae14459013 - null null
2025-05-07 00:40:28.253 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:40:28.265 +03:00 [INF] Route matched with {action = "GetById", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:40:28.395 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:40:28.483 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[ExpenseId], [e].[FileName], [e].[FilePath], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UploadDate]
FROM [ExpenseDocuments] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:40:48.980 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById (Expense_Management_System.WebApi) in 20715.0809ms
2025-05-07 00:40:48.981 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:40:48.982 +03:00 [ERR] HTTP GET /api/ExpenseDocument/95822304-e9b2-4dab-b0eb-e9ae14459013 responded 500 in 20733.3968 ms
System.NullReferenceException: Object reference not set to an instance of an object.
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 53
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:40:49.030 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.GetById(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 53
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:40:49.042 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/ExpenseDocument/95822304-e9b2-4dab-b0eb-e9ae14459013 - 500 null text/plain; charset=utf-8 20811.3926ms
2025-05-07 00:41:16.098 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/ExpenseDocument - multipart/form-data; boundary=----WebKitFormBoundaryHki6MFE5EFbbmyax 71684
2025-05-07 00:41:16.104 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi)'
2025-05-07 00:41:16.112 +03:00 [INF] Route matched with {action = "Create", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Create(Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:41:28.156 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:41:28.439 +03:00 [ERR] Failed executing DbCommand (66ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (Size = 250), @p8='?' (DbType = Boolean), @p9='?' (Size = 100), @p10='?' (DbType = Int32), @p11='?' (Size = 300), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (Size = 250), @p15='?' (DbType = Guid), @p16='?' (DbType = Guid), @p17='?' (DbType = Guid), @p18='?' (Size = 250), @p19='?' (Size = 500), @p20='?' (DbType = DateTime2), @p21='?' (Size = 250), @p22='?' (DbType = DateTime2), @p23='?' (Size = 250), @p24='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Expenses] ([Id], [Amount], [ApprovedAt], [ApprovedByUserId], [Description], [ExpenseCategoryId], [InsertedDate], [InsertedUser], [IsActive], [PaymentLocation], [PaymentMethod], [RejectionReason], [Status], [UpdatedDate], [UpdatedUser], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
INSERT INTO [ExpenseDocuments] ([Id], [ExpenseId], [FileName], [FilePath], [InsertedDate], [InsertedUser], [UpdatedDate], [UpdatedUser], [UploadDate])
OUTPUT INSERTED.[IsActive]
VALUES (@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-05-07 00:41:28.466 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Expense_Management_System.Infrastructure.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6bb9ba25-7037-4ac3-af5a-65966dc3d89f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6bb9ba25-7037-4ac3-af5a-65966dc3d89f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-07 00:41:28.698 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi) in 12585.2285ms
2025-05-07 00:41:28.698 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi)'
2025-05-07 00:41:28.699 +03:00 [ERR] HTTP POST /api/ExpenseDocument responded 500 in 12599.3058 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6bb9ba25-7037-4ac3-af5a-65966dc3d89f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Expense_Management_System.Infrastructure.Repositories.GenericRepository`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\GenericRepository.cs:line 26
   at Expense_Management_System.Application.Services.GenericService`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 24
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create(ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 76
   at lambda_method218(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:41:28.717 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6bb9ba25-7037-4ac3-af5a-65966dc3d89f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Expense_Management_System.Infrastructure.Repositories.GenericRepository`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\GenericRepository.cs:line 26
   at Expense_Management_System.Application.Services.GenericService`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 24
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create(ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 76
   at lambda_method218(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:41:28.749 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/ExpenseDocument - 500 null text/plain; charset=utf-8 12650.9143ms
2025-05-07 00:42:39.346 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:42:39.994 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:42:39.994 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:42:39.999 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:42:39.999 +03:00 [INF] Hosting environment: Development
2025-05-07 00:42:39.999 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:42:44.242 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:42:44.716 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 2173.0746ms
2025-05-07 00:42:44.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:42:44.762 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 9.885ms
2025-05-07 00:42:44.767 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:42:44.829 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 62.5979ms
2025-05-07 00:42:46.515 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:42:46.796 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 281.8023ms
2025-05-07 00:45:07.425 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:45:07.932 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:45:07.933 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:45:07.935 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:45:07.935 +03:00 [INF] Hosting environment: Development
2025-05-07 00:45:07.935 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:45:09.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:45:10.386 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 651.8942ms
2025-05-07 00:45:10.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:45:10.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:45:10.712 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 9.1544ms
2025-05-07 00:45:10.779 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.3544ms
2025-05-07 00:45:12.172 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:45:12.418 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 246.689ms
2025-05-07 00:45:48.070 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - null null
2025-05-07 00:45:48.430 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:38:47', Current time (UTC): '6.05.2025 21:45:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 00:45:48.471 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 21:38:47', Current time (UTC): '6.05.2025 21:45:48'.
2025-05-07 00:45:48.487 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:45:48.496 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 00:45:48.500 +03:00 [INF] HTTP DELETE /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 401 in 401.2811 ms
2025-05-07 00:45:48.503 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 401 0 null 433.1733ms
2025-05-07 00:46:16.575 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 70
2025-05-07 00:46:16.585 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:46:16.642 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 00:46:18.223 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:46:19.133 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 00:46:19.261 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1034.1617ms.
2025-05-07 00:46:19.267 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 00:46:19.285 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 2639.0087ms
2025-05-07 00:46:19.286 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:46:19.287 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 2708.9158 ms
2025-05-07 00:46:19.299 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 2724.4498ms
2025-05-07 00:47:13.780 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - null null
2025-05-07 00:47:13.854 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:47:13.863 +03:00 [INF] Route matched with {action = "GetById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:47:13.963 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:47:14.061 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:47:14.080 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 116.6788ms.
2025-05-07 00:47:14.082 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 00:47:14.103 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi) in 240.6724ms
2025-05-07 00:47:14.104 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi)'
2025-05-07 00:47:14.104 +03:00 [INF] HTTP GET /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 269.5600 ms
2025-05-07 00:47:14.106 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 327.3482ms
2025-05-07 00:49:42.807 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 296
2025-05-07 00:49:42.855 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:49:42.857 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 00:49:42.858 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 403 in 10.6326 ms
2025-05-07 00:49:42.858 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 403 0 null 50.6451ms
2025-05-07 00:50:45.778 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 296
2025-05-07 00:50:45.800 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:50:45.806 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:50:45.919 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 00:50:45.945 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 139.1826ms
2025-05-07 00:50:45.945 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:50:45.945 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 400 in 162.6989 ms
2025-05-07 00:50:45.945 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 400 null application/problem+json; charset=utf-8 167.3253ms
2025-05-07 00:50:56.303 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 298
2025-05-07 00:50:56.305 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:50:56.305 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:50:56.316 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 00:50:56.317 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 11.467ms
2025-05-07 00:50:56.317 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:50:56.317 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 400 in 13.0249 ms
2025-05-07 00:50:56.317 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 400 null application/problem+json; charset=utf-8 14.155ms
2025-05-07 00:51:22.622 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 296
2025-05-07 00:51:22.624 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:51:22.624 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:51:22.675 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:51:22.722 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:51:22.758 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 00:51:23.315 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (Size = 200), @p1='?' (Size = 255), @p2='?' (Size = 15), @p3='?' (DbType = DateTime2), @p4='?' (Size = 250), @p5='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Address] = @p0, [PasswordHash] = @p1, [PhoneNumber] = @p2, [UpdatedDate] = @p3, [UpdatedUser] = @p4, [WorkPhoneNumber] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2025-05-07 00:51:23.329 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (Size = 200), @p1='?' (Size = 255), @p2='?' (Size = 15), @p3='?' (DbType = DateTime2), @p4='?' (Size = 250), @p5='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Address] = @p0, [PasswordHash] = @p1, [PhoneNumber] = @p2, [UpdatedDate] = @p3, [UpdatedUser] = @p4, [WorkPhoneNumber] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2025-05-07 00:51:23.686 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 1061.9778ms
2025-05-07 00:51:23.687 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:51:23.689 +03:00 [ERR] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 500 in 1066.4705 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method160(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:51:23.760 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method160(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:51:23.788 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 500 null text/plain; charset=utf-8 1167.3138ms
2025-05-07 00:51:53.275 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 296
2025-05-07 00:51:53.293 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:51:53.294 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 00:51:53.365 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:51:53.374 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 00:51:53.393 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 00:51:53.599 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 00:51:53.896 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 596.6848ms
2025-05-07 00:51:53.897 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:51:53.898 +03:00 [ERR] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 500 in 622.5189 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method160(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:51:53.900 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.UserController.Update(Guid id, UserRequest userRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\UserController.cs:line 110
   at lambda_method160(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:51:53.904 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 500 null text/plain; charset=utf-8 629.4806ms
2025-05-07 00:52:25.760 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - null null
2025-05-07 00:52:25.804 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:52:25.811 +03:00 [INF] Route matched with {action = "Delete", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse] Delete(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:52:25.882 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Delete (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:52:25.909 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[ExpenseId], [e].[FileName], [e].[FilePath], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UploadDate]
FROM [ExpenseDocuments] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:52:25.983 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-07 00:52:25.996 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p9='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 250), @p2='?' (Size = 500), @p3='?' (DbType = DateTime2), @p4='?' (Size = 250), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 250), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExpenseDocuments] SET [ExpenseId] = @p0, [FileName] = @p1, [FilePath] = @p2, [InsertedDate] = @p3, [InsertedUser] = @p4, [IsActive] = @p5, [UpdatedDate] = @p6, [UpdatedUser] = @p7, [UploadDate] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-05-07 00:52:26.006 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Delete (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 123.7997ms.
2025-05-07 00:52:26.006 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse'.
2025-05-07 00:52:26.008 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Delete (Expense_Management_System.WebApi) in 196.2487ms
2025-05-07 00:52:26.008 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Delete (Expense_Management_System.WebApi)'
2025-05-07 00:52:26.008 +03:00 [INF] HTTP DELETE /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 200 in 247.8619 ms
2025-05-07 00:52:26.008 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 200 null application/json; charset=utf-8 248.4162ms
2025-05-07 00:53:03.959 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - null null
2025-05-07 00:53:03.969 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:53:03.971 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 00:53:03.971 +03:00 [INF] HTTP DELETE /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 403 in 12.3020 ms
2025-05-07 00:53:03.971 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 403 0 null 13.5267ms
2025-05-07 00:53:45.350 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - multipart/form-data; boundary=----WebKitFormBoundaryNNSiCv8THjUEr854 226214
2025-05-07 00:53:45.368 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:53:45.400 +03:00 [INF] Route matched with {action = "Update", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 00:53:45.523 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:53:45.536 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[ExpenseId], [e].[FileName], [e].[FilePath], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UploadDate]
FROM [ExpenseDocuments] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 00:53:45.548 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExpenseDocuments] SET [UpdatedDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-07 00:53:45.777 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) in 377.6882ms
2025-05-07 00:53:45.778 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 00:53:45.779 +03:00 [ERR] HTTP PUT /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 500 in 427.0125 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update(Guid id, ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 94
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 00:53:45.783 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:54cb7397-edc0-4877-b70e-fd88844df8f5
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update(Guid id, ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 94
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 00:53:45.797 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 500 null text/plain; charset=utf-8 446.9751ms
2025-05-07 00:57:19.347 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 00:57:20.031 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 00:57:20.032 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 00:57:20.034 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 00:57:20.034 +03:00 [INF] Hosting environment: Development
2025-05-07 00:57:20.034 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 00:57:24.576 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 00:57:25.149 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 585.7404ms
2025-05-07 00:57:25.176 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 00:57:25.176 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 00:57:25.187 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 11.5383ms
2025-05-07 00:57:25.251 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 75.2672ms
2025-05-07 00:57:26.828 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 00:57:27.176 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 347.8971ms
2025-05-07 00:58:20.639 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 00:58:20.830 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:58:20.889 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 00:58:22.373 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:58:23.335 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 00:58:23.490 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1110.9133ms.
2025-05-07 00:58:23.498 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 00:58:23.514 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 2620.9193ms
2025-05-07 00:58:23.514 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:58:23.518 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 2867.3065 ms
2025-05-07 00:58:23.525 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 2886.995ms
2025-05-07 00:59:11.856 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 243
2025-05-07 00:59:11.905 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.FormatException: IDX10400: Unable to decode: '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64url encoded string.
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.ValidateAndGetOutputSize(String inputString, Int32 offset, Int32 length)
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.Decode[T](String input, Int32 offset, Int32 length, Func`3 action)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(String rawString, Int32 startIndex, Int32 length, Func`3 action)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-05-07 00:59:11.917 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-05-07 00:59:11.929 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 00:59:11.941 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 00:59:11.941 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 401 in 61.5092 ms
2025-05-07 00:59:11.942 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 401 0 null 85.8148ms
2025-05-07 00:59:44.213 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 00:59:44.231 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:59:44.231 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 00:59:44.347 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 00:59:44.375 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 00:59:44.377 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 29.9692ms.
2025-05-07 00:59:44.378 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 00:59:44.379 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 146.991ms
2025-05-07 00:59:44.379 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 00:59:44.379 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 163.1498 ms
2025-05-07 00:59:44.379 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 167.6564ms
2025-05-07 01:00:12.755 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 243
2025-05-07 01:00:12.814 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:12.819 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 01:00:12.892 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 01:00:12.917 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 97.1611ms
2025-05-07 01:00:12.917 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:12.917 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 400 in 160.5286 ms
2025-05-07 01:00:12.918 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 400 null application/problem+json; charset=utf-8 163.996ms
2025-05-07 01:00:28.086 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 273
2025-05-07 01:00:28.091 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:28.091 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 01:00:28.130 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:00:28.240 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 01:00:28.263 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 01:00:28.270 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 140.2718ms.
2025-05-07 01:00:28.271 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:00:28.281 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 189.7991ms
2025-05-07 01:00:28.281 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:28.281 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 194.3543 ms
2025-05-07 01:00:28.284 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 197.8058ms
2025-05-07 01:00:48.508 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 279
2025-05-07 01:00:48.512 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:48.512 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 01:00:48.521 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 01:00:48.521 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 9.1485ms
2025-05-07 01:00:48.522 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:00:48.522 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 400 in 12.0093 ms
2025-05-07 01:00:48.522 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 400 null application/problem+json; charset=utf-8 18.2642ms
2025-05-07 01:01:15.984 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - application/json 279
2025-05-07 01:01:15.985 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:01:15.998 +03:00 [INF] Route matched with {action = "Update", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.UserRequest) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 01:01:16.127 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:01:16.141 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Id] = @__get_Item_0
2025-05-07 01:01:16.147 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-07 01:01:16.734 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 01:01:16.753 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-07 01:01:16.756 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [PasswordHash] = @p0, [UpdatedDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-05-07 01:01:16.770 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 642.8719ms.
2025-05-07 01:01:16.770 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:01:16.776 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi) in 726.2192ms
2025-05-07 01:01:16.777 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:01:16.777 +03:00 [INF] HTTP PUT /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 792.0884 ms
2025-05-07 01:01:16.777 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 793.3662ms
2025-05-07 01:01:49.737 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32/expenses - null null
2025-05-07 01:01:49.746 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetUserExpenses (Expense_Management_System.WebApi)'
2025-05-07 01:01:49.758 +03:00 [INF] Route matched with {action = "GetUserExpenses", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]]] GetUserExpenses(System.Guid) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 01:01:49.828 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.GetUserExpenses (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:01:49.945 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Address], [t].[Email], [t].[FirstName], [t].[InsertedDate], [t].[InsertedUser], [t].[IsActive], [t].[LastName], [t].[PasswordHash], [t].[PhoneNumber], [t].[Role], [t].[UpdatedDate], [t].[UpdatedUser], [t].[WorkPhoneNumber], [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [t]
LEFT JOIN [Expenses] AS [e] ON [t].[Id] = [e].[UserId]
ORDER BY [t].[Id]
2025-05-07 01:01:50.038 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.GetUserExpenses (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 209.7284ms.
2025-05-07 01:01:50.039 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 01:01:50.068 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.GetUserExpenses (Expense_Management_System.WebApi) in 310.0418ms
2025-05-07 01:01:50.068 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetUserExpenses (Expense_Management_System.WebApi)'
2025-05-07 01:01:50.069 +03:00 [INF] HTTP GET /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32/expenses responded 200 in 330.6932 ms
2025-05-07 01:01:50.069 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32/expenses - 200 null application/json; charset=utf-8 332.1264ms
2025-05-07 01:05:15.769 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Expense/active - null null
2025-05-07 01:05:15.788 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Personnel)
2025-05-07 01:05:15.805 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 01:05:15.805 +03:00 [INF] HTTP GET /api/Expense/active responded 403 in 22.7444 ms
2025-05-07 01:05:15.805 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Expense/active - 403 0 null 36.2479ms
2025-05-07 01:05:23.553 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Expense/pending - null null
2025-05-07 01:05:23.555 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.GetAllPending (Expense_Management_System.WebApi)'
2025-05-07 01:05:23.560 +03:00 [INF] Route matched with {action = "GetAllPending", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]]] GetAllPending() on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 01:05:23.590 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.GetAllPending (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:05:23.615 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__status_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Status] = @__status_0 AND [e].[IsActive] = CAST(1 AS bit)
2025-05-07 01:05:23.622 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.GetAllPending (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 31.9766ms.
2025-05-07 01:05:23.622 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 01:05:23.622 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.GetAllPending (Expense_Management_System.WebApi) in 61.7904ms
2025-05-07 01:05:23.622 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.GetAllPending (Expense_Management_System.WebApi)'
2025-05-07 01:05:23.622 +03:00 [INF] HTTP GET /api/Expense/pending responded 200 in 67.4458 ms
2025-05-07 01:05:23.623 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Expense/pending - 200 null application/json; charset=utf-8 69.6679ms
2025-05-07 01:05:57.741 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/ExpenseDocument - multipart/form-data; boundary=----WebKitFormBoundaryEtm3z20vHOLRIlNR 62883
2025-05-07 01:05:57.757 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi)'
2025-05-07 01:05:57.768 +03:00 [INF] Route matched with {action = "Create", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Create(Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 01:05:57.860 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:06:10.242 +03:00 [ERR] Failed executing DbCommand (45ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (Size = 250), @p8='?' (DbType = Boolean), @p9='?' (Size = 100), @p10='?' (DbType = Int32), @p11='?' (Size = 300), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (Size = 250), @p15='?' (DbType = Guid), @p16='?' (DbType = Guid), @p17='?' (DbType = Guid), @p18='?' (Size = 250), @p19='?' (Size = 500), @p20='?' (DbType = DateTime2), @p21='?' (Size = 250), @p22='?' (DbType = DateTime2), @p23='?' (Size = 250), @p24='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Expenses] ([Id], [Amount], [ApprovedAt], [ApprovedByUserId], [Description], [ExpenseCategoryId], [InsertedDate], [InsertedUser], [IsActive], [PaymentLocation], [PaymentMethod], [RejectionReason], [Status], [UpdatedDate], [UpdatedUser], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
INSERT INTO [ExpenseDocuments] ([Id], [ExpenseId], [FileName], [FilePath], [InsertedDate], [InsertedUser], [UpdatedDate], [UpdatedUser], [UploadDate])
OUTPUT INSERTED.[IsActive]
VALUES (@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-05-07 01:06:10.268 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Expense_Management_System.Infrastructure.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7795d836-ca4b-4b4f-a858-c1957d4f4aac
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7795d836-ca4b-4b4f-a858-c1957d4f4aac
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-07 01:06:10.608 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi) in 12839.774ms
2025-05-07 01:06:10.609 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create (Expense_Management_System.WebApi)'
2025-05-07 01:06:10.610 +03:00 [ERR] HTTP POST /api/ExpenseDocument responded 500 in 12855.8603 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7795d836-ca4b-4b4f-a858-c1957d4f4aac
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Expense_Management_System.Infrastructure.Repositories.GenericRepository`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\GenericRepository.cs:line 26
   at Expense_Management_System.Application.Services.GenericService`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 24
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create(ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 76
   at lambda_method378(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 01:06:10.658 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'InsertedUser', table 'ExpenseManagementDB.dbo.Expenses'; column does not allow nulls. INSERT fails.
Cannot insert the value NULL into column 'FileName', table 'ExpenseManagementDB.dbo.ExpenseDocuments'; column does not allow nulls. INSERT fails.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7795d836-ca4b-4b4f-a858-c1957d4f4aac
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Expense_Management_System.Infrastructure.Repositories.GenericRepository`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\GenericRepository.cs:line 26
   at Expense_Management_System.Application.Services.GenericService`1.AddAsync(TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 24
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Create(ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 76
   at lambda_method378(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 01:06:10.688 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/ExpenseDocument - 500 null text/plain; charset=utf-8 12947.7546ms
2025-05-07 01:07:39.104 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - multipart/form-data; boundary=----WebKitFormBoundarylQWyTCK15dpraA4K 44
2025-05-07 01:07:39.113 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:07:39.133 +03:00 [INF] Route matched with {action = "Update", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 01:07:39.144 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 01:07:39.145 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) in 12.0361ms
2025-05-07 01:07:39.145 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:07:39.145 +03:00 [INF] HTTP PUT /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 400 in 34.8257 ms
2025-05-07 01:07:39.145 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 400 null application/problem+json; charset=utf-8 41.8752ms
2025-05-07 01:08:25.305 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:08:26.194 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:08:26.195 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:08:26.208 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:08:26.208 +03:00 [INF] Hosting environment: Development
2025-05-07 01:08:26.209 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:08:28.616 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:08:29.476 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 882.2818ms
2025-05-07 01:08:29.505 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:08:29.517 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:08:29.517 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 12.2237ms
2025-05-07 01:08:29.597 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 80.3838ms
2025-05-07 01:08:31.630 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:08:31.934 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 305.241ms
2025-05-07 01:08:50.670 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - multipart/form-data; boundary=----WebKitFormBoundaryRdrDjlF2w381CqTl 44
2025-05-07 01:08:52.341 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:08:52.393 +03:00 [INF] Route matched with {action = "Update", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 01:08:54.119 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-07 01:08:54.166 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) in 1767.6825ms
2025-05-07 01:08:54.166 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:08:54.169 +03:00 [INF] HTTP PUT /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 400 in 3479.5883 ms
2025-05-07 01:08:54.179 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 400 null application/problem+json; charset=utf-8 3524.6153ms
2025-05-07 01:15:20.116 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:15:20.633 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:15:20.634 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:15:20.636 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:15:20.637 +03:00 [INF] Hosting environment: Development
2025-05-07 01:15:20.637 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:15:22.654 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:15:23.603 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 964.073ms
2025-05-07 01:15:23.678 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:15:23.678 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:15:23.686 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 8.0813ms
2025-05-07 01:15:23.776 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 98.2959ms
2025-05-07 01:15:25.782 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:15:26.046 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 264.1907ms
2025-05-07 01:16:28.278 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - multipart/form-data; boundary=----WebKitFormBoundarytJGPGHPiLSmuaYAM 226214
2025-05-07 01:16:28.530 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:16:28.572 +03:00 [INF] Route matched with {action = "Update", controller = "ExpenseDocument"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseDocumentResponse]] Update(System.Guid, Expense_Management_System.Application.DTOs.Requests.ExpenseDocumentRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseDocumentController (Expense_Management_System.WebApi).
2025-05-07 01:16:30.376 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:16:32.529 +03:00 [INF] Executed DbCommand (185ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[ExpenseId], [e].[FileName], [e].[FilePath], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UploadDate]
FROM [ExpenseDocuments] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 01:16:32.821 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExpenseDocuments] SET [UpdatedDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-07 01:16:32.837 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExpenseDocuments] SET [UpdatedDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-07 01:16:33.215 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi) in 4636.8993ms
2025-05-07 01:16:33.217 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update (Expense_Management_System.WebApi)'
2025-05-07 01:16:33.224 +03:00 [ERR] HTTP PUT /api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 responded 500 in 4934.3781 ms
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:db73c0d5-f692-46fa-9b4c-36af5cc97f2e
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update(Guid id, ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 95
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 01:16:33.290 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.AggregateException: One or more errors occurred. (New transaction is not allowed because there are other threads running in the session.)
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): New transaction is not allowed because there are other threads running in the session.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction2005(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at Microsoft.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at Microsoft.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso)
   at Microsoft.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevel isolationLevel)
   at System.Data.Common.DbConnection.BeginDbTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(IsolationLevel isolationLevel, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransactionAsync(CancellationToken cancellationToken)
ClientConnectionId:db73c0d5-f692-46fa-9b4c-36af5cc97f2e
Error Number:3988,State:1,Class:16
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at Expense_Management_System.Infrastructure.UnitofWorks.UnitofWork.SaveChangesAsync() in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\UnitfWorks\UnitofWork.cs:line 54
   at Expense_Management_System.Application.Services.GenericService`1.UpdateAsync(Guid id, TEntity entity) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 60
   at Expense_Management_System.WebApi.Controllers.ExpenseDocumentController.Update(Guid id, ExpenseDocumentRequest documentRequest) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseDocumentController.cs:line 95
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 01:16:33.320 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7092/api/ExpenseDocument/2ce53b19-bd6e-43c5-bf9a-ee065c89ae50 - 500 null text/plain; charset=utf-8 5042.3318ms
2025-05-07 01:30:19.132 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:30:19.889 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:30:19.890 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:30:19.893 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:30:19.893 +03:00 [INF] Hosting environment: Development
2025-05-07 01:30:19.893 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:30:20.944 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:30:21.757 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:30:21.759 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:30:21.773 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 845.8707ms
2025-05-07 01:30:21.774 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 16.9896ms
2025-05-07 01:30:21.829 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 70.7252ms
2025-05-07 01:30:23.583 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:30:23.851 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 268.4273ms
2025-05-07 01:30:47.792 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment - null null
2025-05-07 01:30:48.156 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 01:30:48.201 +03:00 [INF] Route matched with {action = "GetAll", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:30:49.590 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:30:50.505 +03:00 [INF] Executed DbCommand (161ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
2025-05-07 01:30:50.562 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetAll (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 968.9547ms.
2025-05-07 01:30:50.572 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 01:30:50.595 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetAll (Expense_Management_System.WebApi) in 2391.4413ms
2025-05-07 01:30:50.596 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 01:30:50.598 +03:00 [INF] HTTP GET /api/Payment responded 200 in 2796.8588 ms
2025-05-07 01:30:50.606 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment - 200 null application/json; charset=utf-8 2814.512ms
2025-05-07 01:31:23.113 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - null null
2025-05-07 01:31:23.167 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByUserId (Expense_Management_System.WebApi)'
2025-05-07 01:31:23.181 +03:00 [INF] Route matched with {action = "GetByUserId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]]] GetByUserId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:31:23.327 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByUserId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:31:23.664 +03:00 [INF] Executed DbCommand (114ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
INNER JOIN [Expenses] AS [e] ON [p].[ExpenseId] = [e].[Id]
WHERE [e].[UserId] = @__userId_0 AND [p].[IsActive] = CAST(1 AS bit)
ORDER BY [p].[PaymentDate] DESC
2025-05-07 01:31:23.667 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByUserId (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 338.9356ms.
2025-05-07 01:31:23.667 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 01:31:23.668 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByUserId (Expense_Management_System.WebApi) in 486.4262ms
2025-05-07 01:31:23.668 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByUserId (Expense_Management_System.WebApi)'
2025-05-07 01:31:23.668 +03:00 [INF] HTTP GET /api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 535.2281 ms
2025-05-07 01:31:23.669 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 573.9047ms
2025-05-07 01:31:43.307 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:31:43.313 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:31:43.319 +03:00 [INF] Route matched with {action = "GetByExpenseId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetByExpenseId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:31:43.367 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:31:43.410 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[ExpenseId] = @__expenseId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-05-07 01:31:43.707 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) in 388.3751ms
2025-05-07 01:31:43.708 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:31:43.709 +03:00 [ERR] HTTP GET /api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 500 in 399.9305 ms
System.Exception: No payment found for expense with ID: dc776fc8-0472-41c3-8beb-877f113a4991
   at Expense_Management_System.Infrastructure.Repositories.PaymentRepository.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\PaymentRepository.cs:line 19
   at Expense_Management_System.Application.Services.PaymentService.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\PaymentService.cs:line 25
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 60
   at lambda_method66(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 01:31:43.802 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: No payment found for expense with ID: dc776fc8-0472-41c3-8beb-877f113a4991
   at Expense_Management_System.Infrastructure.Repositories.PaymentRepository.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\PaymentRepository.cs:line 19
   at Expense_Management_System.Application.Services.PaymentService.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\PaymentService.cs:line 25
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 60
   at lambda_method66(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 01:31:43.815 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 500 null text/plain; charset=utf-8 508.6473ms
2025-05-07 01:31:55.648 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:31:55.658 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:31:55.659 +03:00 [INF] Route matched with {action = "GetByExpenseId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetByExpenseId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:31:55.731 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:31:55.747 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[ExpenseId] = @__expenseId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-05-07 01:31:55.918 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) in 258.7988ms
2025-05-07 01:31:55.919 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:31:55.920 +03:00 [ERR] HTTP GET /api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 500 in 263.9970 ms
System.Exception: No payment found for expense with ID: dc776fc8-0472-41c3-8beb-877f113a4991
   at Expense_Management_System.Infrastructure.Repositories.PaymentRepository.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\PaymentRepository.cs:line 19
   at Expense_Management_System.Application.Services.PaymentService.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\PaymentService.cs:line 25
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 60
   at lambda_method66(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 01:31:55.922 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: No payment found for expense with ID: dc776fc8-0472-41c3-8beb-877f113a4991
   at Expense_Management_System.Infrastructure.Repositories.PaymentRepository.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Infrastructure\Repositories\PaymentRepository.cs:line 19
   at Expense_Management_System.Application.Services.PaymentService.GetPaymentByExpenseIdAsync(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\PaymentService.cs:line 25
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId(Guid expenseId) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 60
   at lambda_method66(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 01:31:55.925 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 500 null text/plain; charset=utf-8 277.1161ms
2025-05-07 01:36:51.855 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:36:52.552 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:36:52.553 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:36:52.556 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:36:52.556 +03:00 [INF] Hosting environment: Development
2025-05-07 01:36:52.556 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:36:53.507 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:36:54.141 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 651.2229ms
2025-05-07 01:36:54.175 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:36:54.175 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:36:54.187 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 12.1768ms
2025-05-07 01:36:54.259 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 84.0813ms
2025-05-07 01:36:55.762 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:36:56.094 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 331.9426ms
2025-05-07 01:37:12.654 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:37:12.914 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:29:44', Current time (UTC): '6.05.2025 22:37:12'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 01:37:12.943 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:29:44', Current time (UTC): '6.05.2025 22:37:12'.
2025-05-07 01:37:12.953 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-07 01:37:12.961 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 01:37:12.965 +03:00 [INF] HTTP GET /api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 401 in 297.1294 ms
2025-05-07 01:37:12.968 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 401 0 null 313.9566ms
2025-05-07 01:37:34.946 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 01:37:34.955 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:29:44', Current time (UTC): '6.05.2025 22:37:34'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 01:37:34.955 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:29:44', Current time (UTC): '6.05.2025 22:37:34'.
2025-05-07 01:37:34.962 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 01:37:35.003 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 01:37:36.651 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:37:37.664 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 01:37:37.803 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1147.3175ms.
2025-05-07 01:37:37.810 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 01:37:37.828 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 2821.5212ms
2025-05-07 01:37:37.829 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 01:37:37.830 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 2880.3996 ms
2025-05-07 01:37:37.838 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 2892.4088ms
2025-05-07 01:37:59.187 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:37:59.268 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:37:59.278 +03:00 [INF] Route matched with {action = "GetByExpenseId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetByExpenseId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:37:59.390 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:37:59.474 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[ExpenseId] = @__expenseId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-05-07 01:37:59.476 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 86.1823ms.
2025-05-07 01:37:59.478 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:37:59.500 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) in 221.1536ms
2025-05-07 01:37:59.500 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:37:59.500 +03:00 [INF] HTTP GET /api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 246.9344 ms
2025-05-07 01:37:59.503 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 316.8918ms
2025-05-07 01:38:35.648 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:38:35.690 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:38:35.698 +03:00 [INF] Route matched with {action = "GetById", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:38:35.763 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:38:35.847 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__get_Item_0
2025-05-07 01:38:36.043 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) in 344.9634ms
2025-05-07 01:38:36.044 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:38:36.045 +03:00 [ERR] HTTP GET /api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 responded 500 in 362.7172 ms
System.Exception: Entity with id dc776fc8-0472-41c3-8beb-877f113a4991 not found.
   at Expense_Management_System.Application.Services.GenericService`1.GetByIdAsync(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 49
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetById(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 42
   at lambda_method159(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 01:38:36.076 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: Entity with id dc776fc8-0472-41c3-8beb-877f113a4991 not found.
   at Expense_Management_System.Application.Services.GenericService`1.GetByIdAsync(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.Application\Services\GenericService.cs:line 49
   at Expense_Management_System.WebApi.Controllers.PaymentController.GetById(Guid id) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\PaymentController.cs:line 42
   at lambda_method159(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 01:38:36.084 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - 500 null text/plain; charset=utf-8 436.8351ms
2025-05-07 01:39:13.946 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:39:14.633 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:39:14.634 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:39:14.638 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:39:14.639 +03:00 [INF] Hosting environment: Development
2025-05-07 01:39:14.639 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:39:15.689 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:39:16.215 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 544.3713ms
2025-05-07 01:39:16.245 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:39:16.247 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:39:16.275 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 28.4128ms
2025-05-07 01:39:16.323 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 78.0928ms
2025-05-07 01:39:17.997 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:39:18.236 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 239.2571ms
2025-05-07 01:39:28.876 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:39:29.065 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-07 01:39:29.070 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 01:39:29.074 +03:00 [INF] HTTP GET /api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 responded 401 in 188.0587 ms
2025-05-07 01:39:29.076 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - 401 0 null 200.6821ms
2025-05-07 01:39:57.148 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:39:57.260 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:39:57.301 +03:00 [INF] Route matched with {action = "GetById", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:39:58.683 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:39:59.668 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__get_Item_0
2025-05-07 01:39:59.698 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1011.2954ms.
2025-05-07 01:39:59.706 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:39:59.731 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) in 2427.061ms
2025-05-07 01:39:59.732 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:39:59.733 +03:00 [INF] HTTP GET /api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 2581.3407 ms
2025-05-07 01:39:59.738 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 2591.0984ms
2025-05-07 01:40:31.371 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:40:31.396 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:16:19', Current time (UTC): '6.05.2025 22:40:31'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 01:40:31.404 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:16:19', Current time (UTC): '6.05.2025 22:40:31'.
2025-05-07 01:40:31.405 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-07 01:40:31.406 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 01:40:31.407 +03:00 [INF] HTTP GET /api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 responded 401 in 24.5578 ms
2025-05-07 01:40:31.407 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - 401 0 null 36.8035ms
2025-05-07 01:40:51.346 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 01:40:51.349 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:16:19', Current time (UTC): '6.05.2025 22:40:51'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 01:40:51.350 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 22:16:19', Current time (UTC): '6.05.2025 22:40:51'.
2025-05-07 01:40:51.350 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 01:40:51.361 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 01:40:51.482 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:40:51.522 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 01:40:51.622 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 139.5325ms.
2025-05-07 01:40:51.622 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 01:40:51.629 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 267.8432ms
2025-05-07 01:40:51.629 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 01:40:51.629 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 281.4545 ms
2025-05-07 01:40:51.636 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 289.2927ms
2025-05-07 01:41:17.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:41:17.755 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:41:17.755 +03:00 [INF] Route matched with {action = "GetById", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:41:17.792 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:41:17.808 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__get_Item_0
2025-05-07 01:41:17.809 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 16.3991ms.
2025-05-07 01:41:17.809 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:41:17.809 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi) in 54.2136ms
2025-05-07 01:41:17.809 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetById (Expense_Management_System.WebApi)'
2025-05-07 01:41:17.809 +03:00 [INF] HTTP GET /api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 55.4010 ms
2025-05-07 01:41:17.810 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 61.3778ms
2025-05-07 01:42:09.294 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - null null
2025-05-07 01:42:09.315 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 01:42:09.318 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-07 01:42:09.318 +03:00 [INF] HTTP GET /api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 403 in 21.3895 ms
2025-05-07 01:42:09.318 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/user/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 403 0 null 24.9996ms
2025-05-07 01:42:17.280 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - null null
2025-05-07 01:42:17.283 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:42:17.302 +03:00 [INF] Route matched with {action = "GetByExpenseId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetByExpenseId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:42:17.333 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:42:17.364 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[ExpenseId] = @__expenseId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-05-07 01:42:17.365 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 31.7174ms.
2025-05-07 01:42:17.365 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:42:17.365 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) in 63.3663ms
2025-05-07 01:42:17.365 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:42:17.365 +03:00 [INF] HTTP GET /api/Payment/expense/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 84.4813 ms
2025-05-07 01:42:17.366 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 86.0533ms
2025-05-07 01:42:26.877 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - null null
2025-05-07 01:42:26.878 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:42:26.878 +03:00 [INF] Route matched with {action = "GetByExpenseId", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.PaymentResponse]] GetByExpenseId(System.Guid) on controller Expense_Management_System.WebApi.Controllers.PaymentController (Expense_Management_System.WebApi).
2025-05-07 01:42:26.904 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:42:26.913 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM [Payments] AS [p]
WHERE [p].[ExpenseId] = @__expenseId_0 AND [p].[IsActive] = CAST(1 AS bit)
2025-05-07 01:42:26.913 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 8.5069ms.
2025-05-07 01:42:26.913 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.PaymentResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 01:42:26.913 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi) in 35.1533ms
2025-05-07 01:42:26.913 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.PaymentController.GetByExpenseId (Expense_Management_System.WebApi)'
2025-05-07 01:42:26.913 +03:00 [INF] HTTP GET /api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 36.0545 ms
2025-05-07 01:42:26.914 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/Payment/expense/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 36.9177ms
2025-05-07 01:54:35.999 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:54:36.663 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:54:36.663 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:54:36.666 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:54:36.666 +03:00 [INF] Hosting environment: Development
2025-05-07 01:54:36.666 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:54:37.937 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:54:39.501 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 1587.2132ms
2025-05-07 01:54:39.541 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:54:39.542 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:54:39.561 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 19.4949ms
2025-05-07 01:54:39.673 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 131.0084ms
2025-05-07 01:54:41.931 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:54:42.489 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 557.4897ms
2025-05-07 01:55:15.281 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/dc776fc8-0472-41c3-8beb-877f113a4991 - null 0
2025-05-07 01:55:15.530 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi)'
2025-05-07 01:55:15.568 +03:00 [INF] Route matched with {action = "Approve", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Approve(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 01:55:16.922 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:55:17.935 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 01:55:18.204 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [ApprovedAt] = @p0, [Status] = @p1, [UpdatedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-05-07 01:58:12.197 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 01:58:12.885 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 01:58:12.886 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 01:58:12.888 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 01:58:12.888 +03:00 [INF] Hosting environment: Development
2025-05-07 01:58:12.888 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 01:58:13.909 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 01:58:14.551 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 664.4907ms
2025-05-07 01:58:14.569 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 01:58:14.569 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 01:58:14.578 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 9.507ms
2025-05-07 01:58:14.639 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 70.0754ms
2025-05-07 01:58:16.480 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 01:58:16.743 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 263.3336ms
2025-05-07 01:59:01.954 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/dc776fc8-0472-41c3-8beb-877f113a4991 - null 0
2025-05-07 01:59:02.252 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi)'
2025-05-07 01:59:02.300 +03:00 [INF] Route matched with {action = "Approve", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Approve(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 01:59:03.678 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 01:59:04.732 +03:00 [INF] Executed DbCommand (90ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId]
FROM [Expenses] AS [e]
WHERE [e].[Id] = @__get_Item_0
2025-05-07 01:59:05.032 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [ApprovedAt] = @p0, [Status] = @p1, [UpdatedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-05-07 02:03:59.083 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 02:03:59.850 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 02:03:59.851 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 02:03:59.853 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 02:03:59.854 +03:00 [INF] Hosting environment: Development
2025-05-07 02:03:59.854 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 02:04:00.871 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 02:04:01.455 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 599.0932ms
2025-05-07 02:04:01.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 02:04:01.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 02:04:01.530 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 12.5009ms
2025-05-07 02:04:01.574 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.7476ms
2025-05-07 02:04:03.954 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 02:04:04.256 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 302.0605ms
2025-05-07 02:04:30.966 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - null 0
2025-05-07 02:04:31.216 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi)'
2025-05-07 02:04:31.257 +03:00 [INF] Route matched with {action = "Approve", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Approve(System.Guid) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 02:04:32.864 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:04:33.899 +03:00 [INF] Executed DbCommand (104ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId], [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber], [b].[Id], [b].[AccountNumber], [b].[IBAN], [b].[InsertedDate], [b].[InsertedUser], [b].[IsActive], [b].[UpdatedDate], [b].[UpdatedUser], [b].[UserId]
FROM [Expenses] AS [e]
INNER JOIN [Users] AS [u] ON [e].[UserId] = [u].[Id]
LEFT JOIN [BankAccounts] AS [b] ON [u].[Id] = [b].[UserId]
WHERE [e].[Id] = @__expenseId_0
2025-05-07 02:04:34.201 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [ApprovedAt] = @p0, [Status] = @p1, [UpdatedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-05-07 02:10:47.473 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 250), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Int32), @p10='?' (Size = 100), @p11='?' (DbType = DateTime2), @p12='?' (Size = 250), @p13='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Id], [Amount], [BankAccountNumber], [ExpenseId], [FailureReason], [InsertedDate], [InsertedUser], [IsSuccessful], [PaymentDate], [PaymentMethod], [TransactionReference], [UpdatedDate], [UpdatedUser], [UserId])
OUTPUT INSERTED.[IsActive]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-05-07 02:10:52.211 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 379337.3763ms.
2025-05-07 02:10:52.229 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 02:10:55.969 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi) in 384705.4711ms
2025-05-07 02:10:55.970 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Approve (Expense_Management_System.WebApi)'
2025-05-07 02:10:55.976 +03:00 [INF] HTTP POST /api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad responded 200 in 384999.0573 ms
2025-05-07 02:10:55.990 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/approve/54d39866-a7c0-45e4-936a-1317b85c21ad - 200 null application/json; charset=utf-8 385024.1899ms
2025-05-07 02:12:32.689 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - application/json 34
2025-05-07 02:12:32.711 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi)'
2025-05-07 02:12:32.728 +03:00 [INF] Route matched with {action = "Reject", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Reject(System.Guid, Expense_Management_System.Application.DTOs.Requests.RejectExpenseRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 02:12:32.938 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:12:32.966 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId], [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber], [b].[Id], [b].[AccountNumber], [b].[IBAN], [b].[InsertedDate], [b].[InsertedUser], [b].[IsActive], [b].[UpdatedDate], [b].[UpdatedUser], [b].[UserId]
FROM [Expenses] AS [e]
INNER JOIN [Users] AS [u] ON [e].[UserId] = [u].[Id]
LEFT JOIN [BankAccounts] AS [b] ON [u].[Id] = [b].[UserId]
WHERE [e].[Id] = @__expenseId_0
2025-05-07 02:12:33.172 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi) in 443.3738ms
2025-05-07 02:12:33.173 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi)'
2025-05-07 02:12:33.174 +03:00 [ERR] HTTP POST /api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 responded 500 in 480.7130 ms
System.Exception: Only pending expenses can be rejected
   at Expense_Management_System.Application.Services.ExpenseService.RejectExpenseAsync(Guid expenseId, Guid adminId, String rejectionReason)
   at Expense_Management_System.WebApi.Controllers.ExpenseController.Reject(Guid expenseId, RejectExpenseRequest reject) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseController.cs:line 145
   at lambda_method581(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-07 02:12:33.228 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: Only pending expenses can be rejected
   at Expense_Management_System.Application.Services.ExpenseService.RejectExpenseAsync(Guid expenseId, Guid adminId, String rejectionReason)
   at Expense_Management_System.WebApi.Controllers.ExpenseController.Reject(Guid expenseId, RejectExpenseRequest reject) in D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi\Controllers\ExpenseController.cs:line 145
   at lambda_method581(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-07 02:12:33.238 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - 500 null text/plain; charset=utf-8 550.3794ms
2025-05-07 02:13:41.955 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - application/json 34
2025-05-07 02:13:41.991 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 23:07:37', Current time (UTC): '6.05.2025 23:13:41'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-05-07 02:13:41.995 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6.05.2025 23:07:37', Current time (UTC): '6.05.2025 23:13:41'.
2025-05-07 02:13:41.999 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-07 02:13:42.008 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-07 02:13:42.009 +03:00 [INF] HTTP POST /api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 responded 401 in 29.5624 ms
2025-05-07 02:13:42.009 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - 401 0 null 53.8979ms
2025-05-07 02:14:13.390 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Auth/login - application/json 64
2025-05-07 02:14:13.393 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 02:14:13.455 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Expense_Management_System.Application.DTOs.Requests.LoginRequest) on controller Expense_Management_System.WebApi.Controllers.AuthController (Expense_Management_System.WebApi).
2025-05-07 02:14:13.512 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:14:13.549 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-05-07 02:14:13.573 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 60.8176ms.
2025-05-07 02:14:13.574 +03:00 [INF] Executing OkObjectResult, writing value of type 'Expense_Management_System.Application.DTOs.Responses.LoginResponse'.
2025-05-07 02:14:13.576 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi) in 120.9931ms
2025-05-07 02:14:13.576 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.AuthController.Login (Expense_Management_System.WebApi)'
2025-05-07 02:14:13.576 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 183.1328 ms
2025-05-07 02:14:13.580 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Auth/login - 200 null application/json; charset=utf-8 189.7656ms
2025-05-07 02:14:46.591 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - application/json 34
2025-05-07 02:14:46.615 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi)'
2025-05-07 02:14:46.616 +03:00 [INF] Route matched with {action = "Reject", controller = "Expense"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse]] Reject(System.Guid, Expense_Management_System.Application.DTOs.Requests.RejectExpenseRequest) on controller Expense_Management_System.WebApi.Controllers.ExpenseController (Expense_Management_System.WebApi).
2025-05-07 02:14:46.656 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:14:46.666 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__expenseId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId], [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber], [b].[Id], [b].[AccountNumber], [b].[IBAN], [b].[InsertedDate], [b].[InsertedUser], [b].[IsActive], [b].[UpdatedDate], [b].[UpdatedUser], [b].[UserId]
FROM [Expenses] AS [e]
INNER JOIN [Users] AS [u] ON [e].[UserId] = [u].[Id]
LEFT JOIN [BankAccounts] AS [b] ON [u].[Id] = [b].[UserId]
WHERE [e].[Id] = @__expenseId_0
2025-05-07 02:14:46.681 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Size = 300), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Expenses] SET [RejectionReason] = @p0, [Status] = @p1, [UpdatedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-05-07 02:14:46.688 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 30.0503ms.
2025-05-07 02:14:46.688 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.ExpenseResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 02:14:46.695 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi) in 78.8736ms
2025-05-07 02:14:46.695 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.ExpenseController.Reject (Expense_Management_System.WebApi)'
2025-05-07 02:14:46.695 +03:00 [INF] HTTP POST /api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 responded 200 in 92.0887 ms
2025-05-07 02:14:46.695 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7092/api/Expense/reject/dc776fc8-0472-41c3-8beb-877f113a4991 - 200 null application/json; charset=utf-8 104.5827ms
2025-05-07 02:18:42.132 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 02:18:42.935 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 02:18:42.935 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 02:18:42.938 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 02:18:42.939 +03:00 [INF] Hosting environment: Development
2025-05-07 02:18:42.939 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 02:18:44.248 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 02:18:45.063 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 843.6389ms
2025-05-07 02:18:45.075 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 02:18:45.075 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 02:18:45.089 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 14.5284ms
2025-05-07 02:18:45.156 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 81.4715ms
2025-05-07 02:18:47.377 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 02:18:47.663 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 286.5861ms
2025-05-07 02:18:57.661 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/User - null null
2025-05-07 02:18:57.896 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 02:18:57.925 +03:00 [INF] Route matched with {action = "GetAll", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[System.Collections.Generic.IEnumerable`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]]] GetAll() on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 02:18:59.273 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:19:00.087 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
FROM [Users] AS [u]
2025-05-07 02:19:00.220 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 942.9803ms.
2025-05-07 02:19:00.229 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[System.Collections.Generic.IEnumerable`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-07 02:19:00.280 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi) in 2351.2176ms
2025-05-07 02:19:00.281 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetAll (Expense_Management_System.WebApi)'
2025-05-07 02:19:00.284 +03:00 [INF] HTTP GET /api/User responded 200 in 2615.4561 ms
2025-05-07 02:19:00.291 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/User - 200 null application/json; charset=utf-8 2630.2551ms
2025-05-07 02:26:08.996 +03:00 [INF] User profile is available. Using 'C:\Users\BERKAY\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-07 02:26:09.736 +03:00 [INF] Now listening on: https://localhost:7092
2025-05-07 02:26:09.737 +03:00 [INF] Now listening on: http://localhost:5243
2025-05-07 02:26:09.739 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-07 02:26:09.740 +03:00 [INF] Hosting environment: Development
2025-05-07 02:26:09.740 +03:00 [INF] Content root path: D:\Belgelerim\C# Projeleri\Expense_Management_System\Expense_Management_System.WebApi
2025-05-07 02:26:10.623 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/index.html - null null
2025-05-07 02:26:11.560 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/index.html - 200 null text/html;charset=utf-8 957.9696ms
2025-05-07 02:26:11.597 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_vs/browserLink - null null
2025-05-07 02:26:11.597 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - null null
2025-05-07 02:26:11.607 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_framework/aspnetcore-browser-refresh.js - 200 13800 application/javascript; charset=utf-8 10.0015ms
2025-05-07 02:26:11.718 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/_vs/browserLink - 200 null text/javascript; charset=UTF-8 121.2858ms
2025-05-07 02:26:13.624 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - null null
2025-05-07 02:26:13.880 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 256.5436ms
2025-05-07 02:26:34.374 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - null null
2025-05-07 02:26:34.723 +03:00 [INF] Executing endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi)'
2025-05-07 02:26:34.774 +03:00 [INF] Route matched with {action = "GetById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[Expense_Management_System.Application.DTOs.Responses.UserResponse]] GetById(System.Guid) on controller Expense_Management_System.WebApi.Controllers.UserController (Expense_Management_System.WebApi).
2025-05-07 02:26:36.150 +03:00 [INF] Executing action method Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi) - Validation state: "Valid"
2025-05-07 02:26:36.605 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-05-07 02:26:37.322 +03:00 [INF] Executed DbCommand (218ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Address], [t].[Email], [t].[FirstName], [t].[InsertedDate], [t].[InsertedUser], [t].[IsActive], [t].[LastName], [t].[PasswordHash], [t].[PhoneNumber], [t].[Role], [t].[UpdatedDate], [t].[UpdatedUser], [t].[WorkPhoneNumber], [e].[Id], [e].[Amount], [e].[ApprovedAt], [e].[ApprovedByUserId], [e].[Description], [e].[ExpenseCategoryId], [e].[InsertedDate], [e].[InsertedUser], [e].[IsActive], [e].[PaymentLocation], [e].[PaymentMethod], [e].[RejectionReason], [e].[Status], [e].[UpdatedDate], [e].[UpdatedUser], [e].[UserId], [p].[Id], [p].[Amount], [p].[BankAccountNumber], [p].[ExpenseId], [p].[FailureReason], [p].[InsertedDate], [p].[InsertedUser], [p].[IsActive], [p].[IsSuccessful], [p].[PaymentDate], [p].[PaymentMethod], [p].[TransactionReference], [p].[UpdatedDate], [p].[UpdatedUser], [p].[UserId]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Address], [u].[Email], [u].[FirstName], [u].[InsertedDate], [u].[InsertedUser], [u].[IsActive], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedDate], [u].[UpdatedUser], [u].[WorkPhoneNumber]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [t]
LEFT JOIN [Expenses] AS [e] ON [t].[Id] = [e].[UserId]
LEFT JOIN [Payments] AS [p] ON [t].[Id] = [p].[UserId]
ORDER BY [t].[Id], [e].[Id]
2025-05-07 02:26:37.513 +03:00 [INF] Executed action method Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1358.8972ms.
2025-05-07 02:26:37.522 +03:00 [INF] Executing ObjectResult, writing value of type 'Expense_Management_System.WebApi.ApiResponses.ApiResponse`1[[Expense_Management_System.Application.DTOs.Responses.UserResponse, Expense_Management_System.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-07 02:26:37.550 +03:00 [INF] Executed action Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi) in 2771.6273ms
2025-05-07 02:26:37.551 +03:00 [INF] Executed endpoint 'Expense_Management_System.WebApi.Controllers.UserController.GetById (Expense_Management_System.WebApi)'
2025-05-07 02:26:37.554 +03:00 [INF] HTTP GET /api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 responded 200 in 3169.8434 ms
2025-05-07 02:26:37.560 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7092/api/User/f5a3c4b7-7d23-4c6e-91f0-9e0fa54b8f32 - 200 null application/json; charset=utf-8 3186.6489ms
